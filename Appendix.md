## Appendix（FNOの基礎理論）
### 1.1 背景と問題意識
偏微分方程式（PDE）を支配する現象をモデリングする際，単に個々の入力テンソルに対応する出力するだけでなく，**入力関数全体に対する出力関数の写像（作用素）** を直接近似することが望まれる．  
Neural Operator（NO）は，通常のNeural Networkとは異なり，有限次元テンソル間の写像ではなく，入力を関数と解釈し，**関数空間間の写像** を直接近似することを目指して学習を行う． 
この枠組みを理解するためには，まず **関数空間** の構造，特にヒルベルト空間における関数表現の基礎について理解する必要がある．  

以下では，FNOを具体例としてNOの理論的背景を整理する．
### 1.2 ヒルベルト空間と関数表現
ヒルベルト空間は，内積が定義された完備なベクトル空間であり，関数を要素として扱うことができる（無限次元空間上の点として扱うことができる）数学的な枠組みである．  
特に，平方可積分関数全体の集合 $L^2(\Omega)$は，自然な内積  
$<f,g> = \int_\Omega f(x)g(x)dx$  
によってヒルベルト空間を為す．  

直観的には次のような特徴を備えていると解釈できる．
- 関数を無限次元空間上の点（ベクトル）とみなす
- 内積が定義できる
- 任意の点（関数）についてノルムが有限（$\int f(x)^2dx < \infty$のため）
- 空間内の任意のコーシー列の収束先が必ず空間内に含まれる

NOの概念の概要を理解するには，我々が存在する$\mathbb{R}^3$を自然な形で無限次元に拡張したと解釈することでおおむね十分である．  
このような空間では，関数を直交基底（フーリエ基底など）による展開として表現できるため（フーリエ係数がヒルベルト空間上でのフーリエ基底での座標となる），関数間の距離や近似を厳密に扱うことが可能になる．  

### 1.3 FNOによる作用素近似

Fourier Neural Operator（FNO）は，入力をフーリエ変換によって周波数空間に写像し，その周波数成分に対して学習可能な線形変換を適用するアーキテクチャである．  
この過程において，FNOは入力を関数空間（フーリエ基底で関数をベクトルとして扱う空間）上の1点（ベクトル）として解釈し，無限次元のヒルベルト空間における作用素の近似を目指す．  
周波数空間での線形変換は，もとの関数に対する直接的な変換と対応づけられる．特に，フーリエ変換により関数を直交基底上に展開することで，各周波数成分に対して独立に操作を行うことが可能となる．

実際には，周波数成分を保持するのはすべてではなく，低周波数成分のみを抽出し操作を行う．これにより，無限次元空間を有限次元の部分空間に射影し，現実的な計算資源の範囲で作用素近似を実現している．  
低周波成分は入力関数の大域的なトレンドを効率的に表現できる特徴を持つため，FNOは比較的小規模なパラメータ数で大域構造を捉える能力を発揮する．

フーリエ変換においては，高周波成分を加えることで局所的な変動やノイズ的な振る舞いを捉えることも可能である．しかし，多くのPDE問題においては，低周波成分のみでも十分な表現力を持つことが確認されている．

このように，FNOはフーリエ空間を介して関数空間上の低次元射影を行い，関数間の写像を直接学習する枠組みを実現している．
